select
  sign(
    payload   := '{"sub":"1234567890","name":"John Doe","iat":1516239022}',
    secret    := 'secret',
    algorithm := 'HS256'
  );
ERROR:  function public.hmac(text, text, text) does not exist
LINE 9: SELECT public.url_encode(public.hmac(signables, secret, alg....
                                 ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
QUERY:  
WITH
  alg AS (
    SELECT CASE
      WHEN algorithm = 'HS256' THEN 'sha256'
      WHEN algorithm = 'HS384' THEN 'sha384'
      WHEN algorithm = 'HS512' THEN 'sha512'
      ELSE '' END AS id)  -- hmac throws error
SELECT public.url_encode(public.hmac(signables, secret, alg.id)) FROM alg;

CONTEXT:  SQL function "algorithm_sign" during inlining
SQL function "sign" during startup
select
  verify(
    token := 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJuYW1lIjoiRm9vIn0.Q8hKjuadCEhnCPuqIj9bfLhTh_9QSxshTRsA5Aq4IuM',
    secret    := 'secret',
    algorithm := 'HS256'
  );
ERROR:  function public.hmac(text, text, text) does not exist
LINE 9: SELECT public.url_encode(public.hmac(signables, secret, alg....
                                 ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
QUERY:  
WITH
  alg AS (
    SELECT CASE
      WHEN algorithm = 'HS256' THEN 'sha256'
      WHEN algorithm = 'HS384' THEN 'sha384'
      WHEN algorithm = 'HS512' THEN 'sha512'
      ELSE '' END AS id)  -- hmac throws error
SELECT public.url_encode(public.hmac(signables, secret, alg.id)) FROM alg;

CONTEXT:  SQL function "algorithm_sign" during inlining
SQL function "verify" during startup
